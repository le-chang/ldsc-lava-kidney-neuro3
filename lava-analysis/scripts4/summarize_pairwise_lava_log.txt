[lchang24@narval3 scripts4]$ Rscript summarize_pairwise_lava.R
── Attaching core tidyverse packages ───────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.1     ✔ stringr   1.5.2
✔ ggplot2   3.5.2     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

Attaching package: ‘data.table’

The following objects are masked from ‘package:lubridate’:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following objects are masked from ‘package:dplyr’:

    between, first, last

The following object is masked from ‘package:purrr’:

    transpose

========================================
PAIRWISE LAVA RESULTS SUMMARY
========================================

Processing: egfr_pd
---------------------------------------- 
  Univariate tests: 2010 
  Significant (p < 0.05): 735 
  Bivariate tests: 4 
  Significant (p < 0.05): 1 
  Significant (p < 0.01): 0 
  Significant (p < 0.001): 0 

  Top 5 significant results:
   locus   chr    start     stop       rho        p
   <int> <int>    <int>    <int>     <num>    <num>
1:   956     6 30070718 30715006 -0.371118 0.022038

Processing: hematuria_pd
---------------------------------------- 
  Univariate tests: 2850 
  Significant (p < 0.05): 714 
  Bivariate tests: 4 
  Significant (p < 0.05): 0 
  Significant (p < 0.01): 0 
  Significant (p < 0.001): 0 
  No significant bivariate correlations found

Processing: uacr_pd
---------------------------------------- 
  Univariate tests: 2852 
  Significant (p < 0.05): 698 
  Bivariate tests: 0 (file empty)
  Note: No loci passed univariate threshold for bivariate testing

========================================
COMBINED SUMMARY
========================================

UNIVARIATE RESULTS:
  Total tests: 7712 
  Significant (p < 0.05): 2147 

By analysis and phenotype:
# A tibble: 6 × 6
  analysis     phen      n_loci n_sig_05 n_sig_01     min_p
  <chr>        <chr>      <int>    <int>    <int>     <dbl>
1 egfr_pd      egfr         279      158      131 3.59e-146
2 egfr_pd      pd          1731      577      290 1.40e- 38
3 hematuria_pd hematuria   1091      123       52 1.55e- 23
4 hematuria_pd pd          1759      591      294 3.15e- 39
5 uacr_pd      pd          1759      593      294 3.15e- 39
6 uacr_pd      uacr        1093      105       29 1.96e- 53


BIVARIATE RESULTS:
  Total tests: 8 
  Significant (p < 0.05): 1 
  Significant (p < 0.01): 0 
  Significant (p < 0.001): 0 

By trait pair:
# A tibble: 2 × 7
  analysis     n_tests n_sig_05 n_sig_01 n_sig_001  min_p max_abs_rho
  <chr>          <int>    <int>    <int>     <int>  <dbl>       <dbl>
1 egfr_pd            4        1        0         0 0.0220       0.371
2 hematuria_pd       4        0        0         0 0.331        0.160


========================================
ALL SIGNIFICANT BIVARIATE RESULTS (p < 0.05)
========================================

Total significant loci: 1 

  analysis locus chr    start     stop phen1 phen2       rho        p
1  egfr_pd   956   6 30070718 30715006  egfr    pd -0.371118 0.022038


Chromosome distribution of significant loci:
  analysis chr n_loci
1  egfr_pd   6      1


Effect direction (sign of rho):
  analysis direction n_loci
1  egfr_pd  Negative      1


========================================
SAVING RESULTS
========================================

✓ Saved: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/all_pairwise_univariate.tsv 
✓ Saved: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/all_pairwise_bivariate.tsv 
✓ Saved: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/significant_pairwise_bivariate.tsv 
✓ Saved: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/pairwise_summary_stats.tsv 
✓ Saved: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/pairwise_univariate_summary.tsv 


========================================
GENERATING DETAILED REPORT
========================================

✓ Saved detailed report: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/pairwise_lava_report.txt 


Creating comparison with LDSC results...


========================================
LDSC vs LAVA COMPARISON
========================================

            pair                     ldsc_result
1      eGFR - PD  rg=0.0262 (SE=0.0324), p=0.419
2 Hematuria - PD rg=-0.1160 (SE=0.0806), p=0.150
3      uACR - PD rg=-0.0371 (SE=0.0526), p=0.481
                          lava_result
1    1/4 sig (p<0.05), min_p=2.20e-02
2    0/4 sig (p<0.05), min_p=3.31e-01
3 No tests (no loci passed threshold)

✓ Saved comparison: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary/ldsc_vs_lava_comparison.tsv 


========================================
SUMMARY COMPLETE!
========================================

All outputs saved to: /home/lchang24/projects/def-gsarah/lchang24/github/ldsc-lava-kidney-neuro3/lava-analysis/results/pairwise/summary 

Files created:
  1. all_pairwise_univariate.tsv
  2. all_pairwise_bivariate.tsv
  3. significant_pairwise_bivariate.tsv
  4. pairwise_summary_stats.tsv
  5. pairwise_univariate_summary.tsv
  6. pairwise_lava_report.txt
  7. ldsc_vs_lava_comparison.tsv
